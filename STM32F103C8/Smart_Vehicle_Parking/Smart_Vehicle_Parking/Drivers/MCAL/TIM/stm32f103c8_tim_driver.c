/*============================================================================================
 * Module : TIMER
 *
 * File Name : stm32f103c8_tim_driver.c
 *
 * Author: Abdullah Maher
 *
 * Description : Source File Of STM32F103C8 TIMER Driver
 *
 * Created on: Sep 1, 2023
 =============================================================================================*/


/*===============================================================================
 *                                 Includes                                      *
 ================================================================================*/
#include "stm32f103c8_tim_driver.h"
#include "stm32f103c8_rcc_driver.h"
/*===============================================================================
 *                            		MACROS		                                 *
 ================================================================================*/

/*===============================================================================
 *                              Global Variables                                 *
 ================================================================================*/

/*===============================================================================
 *                          Private Function Prototypes	   		                 *
 ================================================================================*/

/*===============================================================================
 *                              API Definitions                                  *
 ================================================================================*/
void Timer2_init(void)
{
	MCAL_RCC_enableCLK(RCC_APB1_BUS, RCC_TIM2_ID);     /*	Enable CLK	*/

	TIM2_PSC = 7;             /* Prescaler CLK = 1MHZ */
	TIM2_ARR = 0xC350;        /* 50000 tick (50000 * 10^-6) = 0.05s */
	TIM2_CR1 |=(1<<0);
	while(!(TIM2_SR)&(1<<0));
}

void Delay_us(uint32_t delay)
{
	TIM2_CNT = 0;
	while(TIM2_CNT<delay);
}

void Delay_ms(uint32_t delay)
{
	uint32_t i = 0;
	for(i = 0; i < delay; i++)
	{
		Delay_us(1000);
	}
}
/*===============================================================================
 *                       		 ISR Functions  		                         *
 ================================================================================*/
