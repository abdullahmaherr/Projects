/*============================================================================================
 * Module : TIMER
 *
 * File Name : stm32f103c8_tim_driver.c
 *
 * Author: Abdullah Maher
 *
 * Description : Source File Of STM32F103C8 TIMER Driver
 *
 * Created on: Sep 1, 2023
 =============================================================================================*/


/*===============================================================================
 *                                 Includes                                      *
 ================================================================================*/
#include "stm32f103c8_tim_driver.h"
/*===============================================================================
 *                            		MACROS		                                 *
 ================================================================================*/

/*===============================================================================
 *                              Global Variables                                 *
 ================================================================================*/

/*===============================================================================
 *                          Private Function Prototypes	   		                 *
 ================================================================================*/

/*===============================================================================
 *                              API Definitions                                  *
 ================================================================================*/
void Timer2_init(void)
{
	RCC_APB1ENR |=(1<<0);     //Enable Rcc for tim2
	TIM2_PSC = 7;             //Clk_input=(8M/(7+1))=1MHZ
	TIM2_ARR = 0xC350;        //to make interrupt after 50000 tike(50000*10^-6)=0.05s
	TIM2_CR1 |=(1<<0);
	while(!(TIM2_SR)&(1<<0));
}

void Delay_us(uint32_t delay)
{
	TIM2_CNT = 0;
	while(TIM2_CNT<delay);
}

void Delay_ms(uint32_t delay)
{
	uint32_t i = 0;
	for(i = 0; i < delay; i++)
	{
		Delay_us(1000);
	}
}
/*===============================================================================
 *                       		 ISR Functions  		                         *
 ================================================================================*/
